# 第五章：Cloud Agent 協作開發實戰

## 專案介紹

本章將透過「**文件歸納切卡機（Learn2Card）**」專案，展示如何使用 Cloud Agent 進行多人協作開發。這個專案的目標是將 Markdown 或純文字文件自動切分成段落、提取重點、進行語意分群，最後生成可翻閱的卡片式介面。

專案採用前後端分離架構：
- **Backend（Agent A）**：Python + uv，負責文本分析與卡片生成
- **Frontend（Agent B）**：React + TypeScript + Vite，負責檔案上傳與卡片展示

**專案位置**：https://github.com/FlagTech/F6722_ch05_Learn2Card.git

---

## 5-1 Cursor 桌面版的 Git 操作與 Remote Rule

本節將介紹 Cursor 桌面版 UI 中的 Git 操作面板使用方式，包括：
- Git 狀態檢視與檔案暫存
- Commit 提交與推送
- 分支管理與切換

接著，介紹與第 3 章不同的進階功能：**Remote Rule（遠端規則）**。Remote Rule 允許團隊將 Cursor 規則集中管理在 Git Repository 中，讓多人協作時能統一開發規範。

**Remote Rule 範例位置**：https://github.com/FlagTech/6722_ch05_company-guidlines.git

透過設定 Remote Rule，團隊成員可以自動同步最新的開發規範，包括：
- Backend 技術棧限制（只能使用 uv，不得使用 pip/poetry）
- Frontend 技術棧限制（只能使用 npm，不得使用 yarn/pnpm）
- Commit Message 格式規範
- 程式碼風格與命名規範

---

## 5-2 Cloud Agent 協作開發流程

本節深入介紹 Cloud Agent 的使用方式，從基礎環境設定到實際協作開發。

### 基礎使用方法
- 如何開啟 Cloud Agent
- 提供 PRD（產品需求文件）給 Agent
- 監控 Agent 的開發進度
- 檢視和測試 Agent 產出的程式碼

### 多 Agent 平行開發
以「文件歸納切卡機」為例，同時開啟兩個 Cloud Agent：

**Agent A（Backend 開發）**：
- 使用 https://github.com/FlagTech/F6722_ch05_Learn2Card/blob/master/docs/prd/agent-a.md 作為需求文件
- 實作文本切分、關鍵詞提取、語意分群等 NLP 功能
- 提供 HTTP API 給前端呼叫
- 輸出標準 JSON 格式的卡片資料

**Agent B（Frontend 開發）**：
- 使用 https://github.com/FlagTech/F6722_ch05_Learn2Card/blob/master/docs/prd/agent-b.md 作為需求文件
- 實作檔案上傳介面
- 整合 Backend API 呼叫
- 實現卡片瀏覽與主題切換功能

兩個 Agent 在各自的分支上平行開發，互不干擾。

**專案與 PRD 位置**：https://github.com/FlagTech/F6722_ch05_Learn2Card.git

### Cloud Agent 自動產生 Pull Request
當 Agent 完成開發後，會自動建立 Pull Request，包含：
- 詳細的變更說明
- 實作的功能清單
- 測試建議

### 多 Agent 整合方法
兩個 Agent 分別完成後，不直接 merge 到 master，而是：
1. 建立第三個 Cloud Agent（整合 Agent）
2. 提供整合需求文件（https://github.com/FlagTech/F6722_ch05_Learn2Card/blob/master/docs/prd/global.md）
3. 由整合 Agent 負責 merge 兩個分支
4. 解決可能的衝突
5. 驗證完整流程（上傳 → 後端分析 → 即時出卡）
6. 確認無誤後才推送到 master

這種方式能有效避免直接 merge 造成的衝突，讓 AI Agent 協助處理整合工作。

---

## 5-3 BugBot 自動審查與 BUGBOT.md 規範

本節介紹如何使用 BugBot 進行自動化程式碼審查，以及如何自訂審查規範。

### BugBot 在 Pull Request 中的運作
當 Cloud Agent 發送 PR 後，BugBot 會自動：
- 掃描程式碼變更
- 依據規範檢查是否有違規項目
- 依嚴重程度分類問題（🔴 嚴重、🟡 重要、🟢 建議）
- 在 PR 中留下審查意見

### Cursor 如何配合 BugBot 修正錯誤
當 BugBot 揪出問題後，可以透過 Cursor：
1. 使用桌機板 Cursor UI的快速修復功能
2. 配合 Cloud Agent 進行快速修復
3. 在 Chat 中請 AI 根據 BugBot 的建議修正

### 自訂 BUGBOT.md 規範
為了讓 BugBot 更貼合專案需求，可以建立 `BUGBOT.md` 檔案來定義自訂規範。

**BUGBOT.md 的撰寫原則**：
- **明確性**：規則描述清楚，不模糊
- **可檢測性**：BugBot 能自動識別違規
- **可執行性**：提供具體的修正方法

**放置位置**：
- https://github.com/FlagTech/F6722_ch05_Learn2Card/blob/add_BUGBOT/.cursor/BUGBOT.md - 全域規範（適用所有程式碼）
- https://github.com/FlagTech/F6722_ch05_Learn2Card/blob/add_BUGBOT/backend/.cursor/BUGBOT.md - Backend 專屬規範
- https://github.com/FlagTech/F6722_ch05_Learn2Card/blob/add_BUGBOT/frontend/.cursor/BUGBOT.md - Frontend 專屬規範

**規範分類**：
- 🔴 **嚴重問題**（禁止合併）：如套件管理器限制、空的錯誤處理
- 🟡 **重要問題**（強烈建議修正）：如語言規範、型別定義
- 🟢 **建議改善**（可選）：如 Commit Message 格式

**BUGBOT.md 範例參考**：
https://github.com/FlagTech/F6722_ch05_Learn2Card/tree/add_BUGBOT

此分支包含完整的 BUGBOT.md 範例，展示如何定義：
- 套件管理器限制（Backend 只能用 uv，Frontend 只能用 npm）
- 依賴管理檔案規範
- 錯誤處理規範
- 語言規範（使用者可見訊息必須使用繁體中文）
- Git Commit Message 格式
- TypeScript 型別定義要求

透過自訂 BUGBOT.md，可以確保所有協作者（包括 Cloud Agent）都遵守專案規範，提升程式碼品質與一致性。

---

## 本章小結

本章透過「文件歸納切卡機」專案，完整展示了 Cloud Agent 的協作開發流程：
1. 使用 Cursor 桌面版進行 Git 操作與 Remote Rule 設定
2. 開啟多個 Cloud Agent 平行開發不同模組
3. 使用整合 Agent 處理分支合併與衝突
4. 透過 BugBot 自動審查確保程式碼品質
5. 自訂 BUGBOT.md 規範讓審查更符合專案需求

這種開發模式讓 AI Agent 成為團隊的得力助手，大幅提升開發效率與程式碼品質。

